<style>.ui-listbox{border:1px solid #E0E0E0;font-size:14px;color:#000;position:relative}.ui-listbox ul{list-style-type:none;width:100%;height:100%;overflow:auto;margin:0;padding:0;overflow-scrolling:touch}.ui-listbox li{border-bottom:1px solid #E0E0E0;padding:5px 10px;cursor:pointer;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;overflow-scrolling:}.ui-listbox li .fa{width:22px;font-size:12px;border-right:1px solid #E0E0E0;margin-right:7px;color:#A0A0A0}.ui-listbox li:hover{background-color:#F0F0F0}.ui-listbox-selected{background-color:#FFE7A4 !important;font-weight:bold}.ui-listbox-search-empty{height:34px}.ui-listbox-search{border-bottom:1px solid #E0E0E0;height:34px;background-color:#FFF;position:absolute;width:100%;box-shadow:0 5px 10px rgba(0,0,0,0.05)}.ui-listbox-search input{width:100%;outline:0;background-color:#FFF;font:normal normal 12px Arial;border:0;margin:0;padding:0}.ui-listbox-search span{float:left;width:30px;text-align:center;height:30px;padding:8px 0 0;font-size:12px;color:#A0A0A0}.ui-listbox-search .fa-times{color:red;cursor:pointer}.ui-listbox-search div{margin-left:30px;padding:6px 10px 0 0}.ui-listbox-invalid{border-color:#E1A1A1;background-color:#FFF3F3 !important}.ui-listbox-invalid .ui-listbox-search{border-color:#E1A1A1}.ui-listbox.ui-listbox-disabled input{background-color:#F0F0F0;color:gray;cursor:not-allowed}.ui-listbox.ui-listbox-disabled .ui-listbox-search{background-color:#F0F0F0;cursor:not-allowed}.ui-listbox.ui-listbox-disabled ul{color:#c7c7c7 !important;overflow:hidden}.ui-listbox.ui-listbox-disabled li:hover{background-color:#FFF}.ui-listbox.ui-listbox-disabled li{cursor:not-allowed}.ui-listbox.ui-listbox-disabled .ui-listbox-selected{background-color:#f1f1f1 !important;color:#c3c3c3 !important}.ui-listbox-container{overflow:hidden}.ui-dark .ui-listbox{border-color:#3A3A3A;background-color:#202020}.ui-dark .ui-listbox li{border-bottom-color:#3A3A3A;color:#FFF}.ui-dark .ui-listbox li:hover{background-color:#2b2b2b}.ui-dark .ui-listbox-selected{background-color:#2b2b2b !important}.ui-dark .ui-listbox-search,.ui-dark .ui-listbox-search input{color:#FFF;background-color:#202020}.ui-dark .ui-listbox-search{border-bottom-color:#4c4c4c}.ui-dark .ui-listbox.ui-listbox-disabled .ui-listbox-selected{background-color:#2b2b2b !important;color:#757575 !important}.ui-dark .ui-listbox.ui-listbox-disabled .ui-listbox-search,.ui-dark .ui-listbox.ui-listbox-disabled input{background-color:#2b2b2b}.ui-dark .ui-listbox.ui-listbox-disabled li{color:#505050}.ui-dark .ui-listbox.ui-listbox-disabled li:hover{background-color:#202020}</style>
<script>COMPONENT('listbox',function(self,config,cls){var cls2='.'+cls,Eitems=null,skip=false;self.items=EMPTYARRAY;self.template=Tangular.compile('<li data-search="{{ search}}" data-index="{{ index}}" style="padding-right:{0}px">{{ if icon}}<i class="fa fa-{{ icon}}"></i>{{ fi}}{{ text}}</li>'.format(SCROLLBARWIDTH()));self.nocompile&&self.nocompile();self.init=function(){var resize=function(){setTimeout2('listboxes_resize',function(){for(var i=0;i<M.components.length;i++){var com=M.components[i];if(com.name==='listbox'&&!(com.config.height>0))com.resize2()}},100)};ON('resize2',resize)};self.validate=function(value){return config.disabled||!config.required?true:value?(config.multiple?value.length>0:true):false};self.make=function(){self.aclass(cls);self.redraw();config.datasource&&self.reconfigure('datasource:'+config.datasource);config.items&&self.reconfigure('items:'+config.items);self.event('click','li',function(){if(config.disabled)return;var index=+this.getAttribute('data-index');var value=self.items[index];skip=true;if(config.multiple){var selected=self.get()||[];if(selected.indexOf(value.value)===-1)selected.push(value.value);else selected=selected.remove(value.value);self.set(selected);config.exec&&EXEC(config.exec,selected)}else{self.set(value.value);config.exec&&EXEC(config.exec,value.value)}self.change(true)});self.event('click','.fa-times',function(){if(!config.disabled){self.find('input').val('');self.search()}});typeof(config.search)==='string'&&self.event('keydown','input',function(){!config.disabled&&setTimeout2(self.id,self.search,500)});self.on('resize + reflow',self.resize2)};self.configure=function(key,value){var redraw=false;switch(key){case'type':self.type=value;break;case'disabled':self.tclass(cls+'-disabled',value);self.find('input').prop('disabled',value);if(value)self.rclass(cls+'-invalid');else if(config.required)self.state(1,1);break;case'required':!value&&self.state(1,1);break;case'search':redraw=true;break;case'height':if(value>0)Eitems.css('height',value+'px');else self.resize();break;case'items':var arr=[];value.split(',').forEach(function(item){item=item.trim().split('|');var obj={};obj.name=item[0].trim();obj.id=(item[1]==null?item[0]:item[1]).trim();if(config.type==='number')obj.id=+obj.id;arr.push(obj)});self.bind('',arr);break;case'datasource':self.datasource(value,self.bind,true);break}redraw&&self.redraw()};self.search=function(){var search=config.search?self.find('input').val().toSearch():'';var first;Eitems.find('li').each(function(){var el=$(this);el.tclass('hidden',el.attrd('search').indexOf(search)===-1);if(!first&&el.hclass(cls+'-selected'))first=el});self.find(cls2+'-search-icon').tclass('fa-search',search.length===0).tclass('fa-times',search.length>0);!skip&&first&&first[0].scrollIntoView(true);skip=false};self.redraw=function(){self.html((typeof(config.search)==='string'?'<div class="{0}-search"><span><i class="fa fa-search {0}-search-icon"></i></span><div><input type="text" placeholder="{1}" /></div></div><div><div class="{0}-search-empty"></div>'.format(cls,config.search):'')+'<div class="{0}-container"><ul style="height:{1}px" class="noscrollbar"></ul></div>'.format(cls,config.height||'200'));self.find('.noscrollbar').noscrollbar();Eitems=self.find('ul');self.resize()};self.resize2=function(){if(!(config.height>0))setTimeout2(self.ID+'resize',self.resize,300)};self.resize=function(){self.width(function(width){var h=0,css={};if(typeof(config.height)==='string'){switch(config.height){case'parent':h=self.element.parent().height();break;case'window':h=WH;break;default:h=self.element.closest(config.height).height();break}css.height=(h-(config.margin||0)-(self.find(cls2+'-search').height()+4))>>0;}Eitems.css(css)})};self.bind=function(path,value){var kt=config.text||'name',kv=config.value||'id',ki=config.icon||'icon',builder=[];self.items=[];value&&value.forEach(function(item,index){var text,value,icon=null;if(typeof(item)==='string'){text=item||'';value=self.parser(item)}else{text=item[kt]||'';value=item[kv];icon=item[ki]}var item={text:text,value:value,index:index,search:text.toSearch(),icon:icon};self.items.push(item);builder.push(self.template(item))});Eitems.empty().append(builder.join(''));self.search()};self.setter=function(value){var selected={},ds=self.items,dsl=ds.length;if(value!=null){if(config.multiple){for(var i=0,length=value.length;i<length;i++){for(var j=0;j<dsl;j++){if(ds[j].value===value[i])selected[j]=true}}}else{for(var j=0;j<dsl;j++){if(ds[j].value===value)selected[j]=true}}}Eitems.find('li').each(function(){var el=$(this);var index=+el.attrd('index');var is=selected[index]!==undefined;el.tclass(cls+'-selected',is)});self.search()};self.state=function(type){if(!type)return;var invalid=config.required?self.isInvalid():false;if(invalid===self.$oldstate)return;self.$oldstate=invalid;self.tclass(cls+'-invalid',invalid)}});</script>