<style>.ui-tree{background-color:#FFF;height:100%}.ui-tree-children{display:none}.ui-tree-item i{width:16px;margin-right:3px}.ui-tree-item span{position:absolute;right:5px;color:#000;cursor:pointer;font-size:12px;margin:2px 0 0;top:7px;display:none}.ui-tree-item{cursor:pointer;padding:7px 18px;font-size:13px;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;border-bottom:1px solid #E8E8E8;position:relative;user-select:none;-webkit-user-select:none;-moz-user-select:none;line-height:0}.ui-tree-item:hover{background-color:#F8F8F8}.ui-tree-item:hover span{display:block}.ui-tree-item>div,.ui-tree .ui-tree-label>div{position:relative;display:inline-block}.ui-tree-show>.ui-tree-children{display:block}.ui-tree-show>.ui-tree-item{font-weight:bold}.ui-tree-label{margin-left:25px;display:block !important;padding:2px 0 0;position:static !important}.ui-tree-selected{background-color:#FFFDE1 !important}.ui-tree input{padding:0;margin:0;outline:0;background-color:#FFF;border:1px solid #E0E0E0;line-height:0;color:#000;outline:0}.ui-tree .ui-tree-ddhere{background-color:#F0F0F0 !important}.ui-tree-checkbox{width:16px;height:16px;line-height:16px;border-radius:2px;background-color:#FFF;border:1px solid #E0E0E0;font-size:11px;text-align:center;float:left;padding:1px 0 0}.ui-tree-checkbox i{display:none;margin:0;width:100% !important}.ui-tree-checkbox-checked{background-color:#4285F4 !important;border-color:#4285F4 !important;color:#FFF}.ui-tree-checkbox-checked i{display:block !important}.ui-tree-folder:before{content:'\f07b';font-weight:900}.ui-tree-show>.ui-tree-expand .ui-tree-folder:before{content:'\f07c'}.ui-tree-children1 .ui-tree-item{padding-left:33px}.ui-tree-children2 .ui-tree-item{padding-left:48px}.ui-tree-children3 .ui-tree-item{padding-left:63px}.ui-tree-children4 .ui-tree-item{padding-left:78px}.ui-tree-children5 .ui-tree-item{padding-left:93px}.ui-tree-children6 .ui-tree-item{padding-left:108px}.ui-tree-children7 .ui-tree-item{padding-left:123px}.ui-tree-children8 .ui-tree-item{padding-left:138px}.ui-tree-children9 .ui-tree-item{padding-left:153px}.ui-tree-children10 .ui-tree-item{padding-left:168px}.ui-dark .ui-tree-ddhere{background-color:#404040 !important}.ui-dark .ui-tree{background-color:#282828;color:#A0A0A0}.ui-dark .ui-tree-item{border-bottom-color:#404040}.ui-dark .ui-tree-selected{background-color:#404040 !important;color:#FFF}.ui-dark .ui-tree-item:hover{background-color:#303030}.ui-dark .ui-tree-show>.ui-tree-item{font-weight:bold;background-color:#353535;color:#D0D0D0}.ui-dark .ui-tree-checkbox{background-color:#303030;border-color:#404040}.ui-dark .ui-tree-item span{color:#FFF}</style>
<script>COMPONENT('tree@1','autoreset:false;checkednested:true;reselect:false;iconoptions:fa fa-ellipsis-h',function(self,config,cls){var cls2='.'+cls,cache=null,counter=0,expanded={},selindex=-1,ddfile=null,ddtarget=null,dragged=null;self.readonly();self.nocompile&&self.nocompile();self.make=function(){self.aclass(cls);self.template=Tangular.compile(('<div'+(config.dragdrop?' draggable="true"':'')+' class="{0}-item{{ if children}} {0}-expand{{ fi}}" title="{{ name}}" data-index="{{ $pointer}}">'+(config.checked?'<div class="{0}-checkbox"><i class="fa fa-check"></i></div><div class="{0}-label">':'')+'<i class="far {{ if children}}{0}-folder{{ else}}{{ icon | def(\'fa-file-o\') }}{{ fi}}"></i>'+(config.options?('<span class="{0}-options"><i class="'+config.iconoptions+'"></i></span>'):'')+'<div class="{0}-item-name{{ if classname}} {{ classname}}{{ fi}}">{{ if html}}{{ html | raw}}{{ else}}{{ name}}{{ fi}}</div></div>'+(config.checked?'</div>':'')).format(cls));self.event('click',cls2+'-checkbox',function(e){e.stopPropagation();var el=$(this);var c=cls+'-checkbox-checked';el.tclass(c);config.checkednested&&el.closest(cls2+'-node').find(cls2+'-checkbox').tclass(c,el.hclass(c));SEEX(self.makepath(config.checked),self.checked(),self)});self.event('click',cls2+'-item',function(){var el=$(this);var index=+el.attrd('index');self.select(index)});self.event('click',cls2+'-options',function(e){e.preventDefault();e.stopPropagation();var el=$(this);var index=+el.closest(cls2+'-item').attrd('index');config.options&&EXEC(self.makepath(config.options),cache[index],el)});self.event('focusout','input',function(){var input=$(this);var el=input.parent();el.html(el[0].$def);el[0].$def=null});var dragdrop=(config.upload||config.dragdrop);dragdrop&&self.event('dragenter dragover dragexit drop dragleave dragstart',function(e){if(e.type==='dragstart'){var el=$(e.target);if(!el.hclass(cls+'-item'))el=el.closest(cls2+'-item');if(el&&el.length){e.originalEvent.dataTransfer.setData('text','1');dragged=el;return}dragged=null}e.stopPropagation();e.preventDefault();switch(e.type){case'drop':break;case'dragenter':case'dragover':if(e.target!==ddtarget||(ddtarget&&e.target!==ddtarget.parentNode)){ddtarget=e.target;ddfile&&ddfile.rclass(cls+'-ddhere');ddfile=$(ddtarget);if(!ddfile.hclass(cls+'-item'))ddfile=ddfile.closest(cls2+'-item');ddfile.aclass(cls+'-ddhere')}return;default:setTimeout2(self.id,function(){ddfile&&ddfile.rclass(cls+'-ddhere');ddfile=null;ddtarget=null},100);return}var index=-1;if(e.originalEvent.dataTransfer.files.length){if(ddfile)index=+ddfile.attrd('index');config.upload&&EXEC(self.makepath(config.upload),cache[index],e.originalEvent.dataTransfer.files)}else{var tmp=$(e.target);if(!tmp.hclass(cls+'-item'))tmp=tmp.closest(cls2+'-item');tmp.length&&config.dragdrop&&EXEC(self.makepath(config.dragdrop),cache[+dragged.attrd('index')],cache[+tmp.attrd('index')],dragged,tmp);dragged=null}ddfile&&ddfile.rclass(cls+'-ddhere');ddfile=null});self.event('keydown','input',function(e){if(e.which===13||e.which===27){var input=$(this);var el=input.parent();if(e.which===27){el.html(el[0].$def);el[0].$def=null}else{var val=input.val().replace(/[^a-z0-9.\-_]/gi,'');var index=+input.closest(cls2+'-item').attrd('index');var item=cache[index],newname=item.path.substring(0,item.path.length-item.name.length)+val;EXEC(self.makepath(config.rename),cache[index],newname,function(is){el.html(is?val:el[0].$def);if(is){item.path=newname;item.name=val;self.select(index)}})}}})};self.select=function(index,noeval,reinit){var el=self.find('[data-index="{0}"]'.format(index));var c='-selected';if(el.hclass(cls+'-expand')){var parent=el.parent();if(config.selectexpand){self.find(cls2+c).rclass(cls+c);el.aclass(cls+c)}if(!reinit)parent.tclass(cls+'-show');var is=parent.hclass(cls+'-show');var item=cache[index];if(config.pk)expanded[item[config.pk]]=1;else expanded[index]=1;!noeval&&config.exec&&SEEX(self.makepath(config.exec),item,true,is);selindex=index}else{!el.hclass(cls+c)&&self.find(cls2+c).rclass(cls+c);el.aclass(cls+c);!noeval&&config.exec&&SEEX(self.makepath(config.exec),cache[index],false);selindex=index}};self.checked=function(){var items=[];self.find(cls2+'-checkbox-checked').each(function(){var item=cache[+$(this).parent().attrd('index')];item&&items.push(item)});return items};self.rename=function(index){var div=self.find('[data-index="{0}"] .ui-tree-item-name'.format(index));if(div[0].$def)return;div[0].$def=div.html();div.html('<input type="text" value="{0}" />'.format(div[0].$def));div.find('input').focus()};self.select2=function(index){self.expand(index);self.select(index,true)};self.unselect=function(){var cls=config.selected;self.find('.'+cls).rclass(cls)};self.clear=function(){expanded={};selindex=-1};self.expand=function(index){if(index==null){self.find(cls2+'-expand').each(function(){$(this).parent().aclass(cls+'-show')})}else{self.find('[data-index="{0}"]'.format(index)).each(function(){var el=$(this);if(el.hclass(cls+'-expand')){el.parent().aclass(cls+'-show')}else{while(true){el=el.closest(cls2+'-children').prev();if(!el.hclass(cls+'-expand'))break;el.parent().aclass(cls+'-show')}}})}};self.collapse=function(index){if(index==null){self.find(cls2+'-expand').each(function(){$(this).parent().rclass(cls+'-show')})}else{self.find('[data-index="{0}"]'.format(index)).each(function(){var el=$(this);if(el.hclass(cls+'-expand')){el.parent().rclass(cls+'-show')}else{while(true){el=el.closest(cls2+'-children').prev();if(!el.hclass(cls+'-expand'))break;el.parent().rclass(cls+'-show');var parent=el.parent().aclass(cls+'-show');var tmp=+parent.find('> .item').attrd('index');var item=cache[tmp],key=config.pk?item[config.pk]:counter;expanded[key]=1;item.isopen=true}}})}};self.renderchildren=function(builder,item,level,selected){builder.push('<div class="{0}-children {0}-children{1}" data-level="{1}">'.format(cls,level));item.children.forEach(function(item){counter++;item.$pointer=counter;cache[counter]=item;var key=config.pk?item[config.pk]:counter;if(key===selected)selindex=counter;builder.push('<div class="{0}-node{1}">'.format(cls,expanded[key]&&item.children?' ui-tree-show':''));builder.push(self.template(item));item.children&&self.renderchildren(builder,item,level+1,selected);builder.push('</div>')});builder.push('</div>')};self.reset=function(){var cls=config.selected;self.find('.'+cls).rclass(cls)};self.first=function(){cache.first&&self.select(cache.first.$pointer)};self.setter=function(value){config.autoreset&&self.clear();var builder=[],selected=selindex===-1?-1:config.pk?cache[selindex][config.pk]:cache[selindex];selindex=-1;counter=0;cache={};var isexpand=false;value&&value.forEach(function(item){counter++;item.$pointer=counter;cache[counter]=item;var key=config.pk?item[config.pk]:counter;if(key===selected)selindex=counter;builder.push('<div class="{0}-node{1}">'.format(cls,expanded[key]&&item.children?' ui-tree-show':'')+self.template(item));if(expanded[key])isexpand=true;if(item.children)self.renderchildren(builder,item,1,selected);else if(!cache.first)cache.first=item;builder.push('</div>')});self.html(builder.join(''));if(selindex!==-1){self.select(selindex,!config.reselect,true)}else config.first!==false&&cache.first&&setTimeout(self.first,100);if(!isexpand&&config.expanded)self.expand();config.checked&&EXEC(self.makepath(config.checked),EMPTYARRAY,self)}});</script>